 <!-- Удалить camel-spring-boot, так как он включен в starter -->
    <dependency>
        <groupId>org.apache.camel.springboot</groupId>
        <artifactId>camel-spring-boot-starter</artifactId>
        <version>${camel.version}</version>
    </dependency>

    <!-- Обновленные компоненты -->
    <dependency>
        <groupId>org.apache.camel</groupId>
        <artifactId>camel-jetty-starter</artifactId> <!-- Было camel-jetty9 -->
        <version>${camel.version}</version>
    </dependency>
    
    <dependency>
        <groupId>org.apache.camel</groupId>
        <artifactId>camel-http-starter</artifactId> <!-- Было camel-http4 -->
        <version>${camel.version}</version>
    </dependency>


Namespace и конфигурация контекста
xml
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
         http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
         http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

    <camelContext xmlns="http://camel.apache.org/schema/spring" id="gate_rr_adapter" useMDCLogging="true" logMask="true">
        <!-- Конфигурация остается прежней -->
    </camelContext>
</beans>




<rest path="/private">
    <post uri="/v2/gate_rr_adapter/createPackage">
        <description>Создание нового пакета</description>
        <param name="Authorization" type="header" required="true" description="Токен авторизации (Bearer)"/>
        <param name="body" type="body" description="json - запрос" required="true"/>
        <route>
            <setProperty name="methodName">
                <simple>createPackage</simple>
            </setProperty>
            <to uri="direct:getMethodStartTime"/>
            
            <doTry>
                <!-- Остальная логика маршрута остается прежней -->
                <to uri="direct:ru.seventech.esb.technoprom.prepareRequest.v2"/>
                
                <doCatch>
                    <exception>org.apache.camel.http.base.HttpOperationFailedException</exception>
                    <setHeader name="Exchange.HTTP_RESPONSE_STATUS">
                        <constant>400</constant>
                    </setHeader>
                    <setBody>
                        <simple>${exception.responseBody}</simple>
                    </setBody>
                </doCatch>
            </doTry>
        </route>
    </post>
</rest>



Критические изменения в Camel 3.x
Пакеты исключений:

org.apache.camel.http.common.HttpOperationFailedException → org.apache.camel.http.base.HttpOperationFailedException

Компоненты:

Компонент http4 переименован в http

Компонент jetty9 переименован в jetty


<doCatch>
								<exception>org.apache.camel.http.common.HttpOperationFailedException</exception>
								<setProperty name="httpResponseCode">
										<groovy>${exception.getStatusCode()}</groovy>
								</setProperty>
								<to uri="log:ru.seventech.esb.technoprom.performPostRequest.httpError?showAll=true"/>
								<setHeader name="Exchange.HTTP_RESPONSE_STATUS">
										<simple>${exchangeProperty.httpResponseCode}</simple>
								</setHeader>
								<setBody>
										<simple>${exception.getResponseBody()}</simple>
								</setBody>
								<stop/>
						</doCatch>
						<doCatch>
							<exception>java.net.SocketTimeoutException</exception>
							<handled>
								<constant>false</constant>
							</handled>
						</doCatch>
						<doCatch>
							<exception>java.net.SocketException</exception>
							<handled>
								<constant>false</constant>
							</handled>
						</doCatch>
						<doCatch>
								<exception>java.lang.Exception</exception>
								<to uri="log:ru.seventech.esb.technoprom.performPostRequest.generalError?showAll=true"/>
								<setHeader name="Exchange.HTTP_RESPONSE_STATUS">
										<constant>500</constant>
								</setHeader>
								<setBody>
										<simple>Error processing request: ${exception.message}</simple>
								</setBody>
								<stop/>
						</doCatch>
